generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Teacher {
  id         Int      @id @default(autoincrement())
  email      String   @unique
  name       String
  created_at DateTime @default(now()) @db.Timestamptz(6)
  classes    Class[]

  @@map("teachers")
}

model Class {
  id          Int      @id @default(autoincrement())
  teacher_id  Int
  class_name  String
  access_code String?
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  teacher     Teacher  @relation(fields: [teacher_id], references: [id], onDelete: Cascade)
  students    Student[]

  @@map("classes")
}

model Student {
  id           Int            @id @default(autoincrement())
  class_id     Int
  student_name String
  label        String?
  created_at   DateTime       @default(now()) @db.Timestamptz(6)
  class        Class          @relation(fields: [class_id], references: [id], onDelete: Cascade)
  attempts     LevelAttempt[]

  @@unique([class_id, student_name])
  @@map("students")
}

model LevelAttempt {
  id                 Int      @id @default(autoincrement())
  student_id         Int
  level_name         String
  time_elapsed       Float    @db.Real
  checkpoint_time    Float?   @db.Real
  reached_checkpoint Boolean
  created_at         DateTime @default(now()) @db.Timestamptz(6)
  student            Student  @relation(fields: [student_id], references: [id], onDelete: Cascade)

  @@map("level_attempts")
}
